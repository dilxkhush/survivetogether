<!DOCTYPE html>
<!-- 1. ADDED scroll-smooth for anchor link navigation -->
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- 2. UPDATED title to match request exactly -->
    <title>Survive Together</title>
    
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Load Inter font -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap">
    
    <!-- Load Leaflet.js for Map -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    
    <!-- Configure Tailwind for Dark Mode -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {},
            }
        }
    </script>
    
    <!--
      Theme Toggle Script
      This runs first to prevent Flash of Unstyled Content (FOUC)
    -->
    <script>
        // On page load or when changing themes, best to add inline in `head` to avoid FOUC
        if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
          document.documentElement.classList.add('dark')
        } else {
          document.documentElement.classList.remove('dark')
        }
    </script>
    
    <style>
        /* Apply Inter font */
        :root {
            scroll-behavior: smooth;
        }
        body {
            font-family: 'Inter', sans-serif;
            /* Smooth color transitions for dark mode */
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        
        /* Map Container Height */
        #map {
            height: 450px;
            border-radius: 0.5rem;
            z-index: 10; /* Ensure map is interactable */
        }
        
        /* Leaflet Dark Mode Popup */
        .dark .leaflet-popup-content-wrapper {
            background-color: #374151; /* gray-700 */
            color: #f3f4f6; /* gray-100 */
        }
        .dark .leaflet-popup-tip {
            background-color: #374151; /* gray-700 */
        }
        .dark .leaflet-control-attribution a {
            color: #9ca3af; /* gray-400 */
        }
        
        /* Style for the modal backdrop (REMOVED as modals are no longer used) */
        
        /* Hide scrollbar when modal is open (REMOVED) */
        
        /* Hero section background */
        /* MODIFIED: This is now just a container */
        .hero-background {
            position: relative;
            overflow: hidden; /* To contain the slides */
        }

        /* NEW: Styles for hero background slides */
        .hero-slide {
            position: absolute;
            inset: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            opacity: 0;
            transition: opacity 1.5s ease-in-out;
            z-index: 1;
        }
        /* NEW: Overlay for each slide */
        .hero-slide::before {
            content: "";
            position: absolute;
            inset: 0;
            background: rgba(0, 0, 0, 0.6);
            z-index: 2; /* Overlay is on top of slide image */
        }
        
        /* MODIFIED: Hero content z-index */
        .hero-content {
            position: relative;
            z-index: 3; /* Content is on top of slide and overlay */
        }
        
        /* Loading spinner */
        .spinner {
            border: 2px solid rgba(0, 0, 0, 0.1);
            border-left-color: #fff;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            animation: spin 1s linear infinite;
        }
        .dark .spinner {
            border-left-color: #ddd;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* 3. UPDATED progress bar to a shimmer effect */
        .progress-bar-fill {
            /* Based on the 'bg-green-500' class that was in the HTML */
            background-color: #22c55e; 
            background-image: linear-gradient(to right, #22c55e 0%, #86efac 20%, #22c55e 40%, #22c55e 100%);
            background-repeat: no-repeat;
            background-size: 1000px 100%;
            animation: progress-active 3s infinite linear;
            transition: width 1.5s ease-out; /* Keep original transition */
        }
        
        /* 3. UPDATED keyframes for shimmer effect */
        @keyframes progress-active {
            0% { background-position: -1000px 0; }
            100% { background-position: 1000px 0; }
        }

        /* Image Slider (Carousel) */
        .slider-container {
            position: relative;
            max-width: 800px;
            margin: auto;
            overflow: hidden;
            border-radius: 0.5rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .dark .slider-container {
             box-shadow: 0 0 15px rgba(0,0,0,0.2);
             border: 1px solid #374151; /* gray-700 */
        }
        .slider-wrapper {
            display: flex;
            transition: transform 0.5s ease-in-out;
        }
        .slider-slide {
            min-width: 100%;
            box-sizing: border-box;
        }
        .slider-slide img {
            width: 100%;
            height: 450px;
            object-fit: cover;
            display: block;
        }
        .slider-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 100%;
            display: flex;
            justify-content: space-between;
            padding: 0 1rem;
            box-sizing: border-box;
            z-index: 20; /* Above slider images */
        }
        .slider-nav button {
            background-color: rgba(255, 255, 255, 0.7);
            color: #111;
            border: none;
            border-radius: 50%;
            width: 2.5rem;
            height: 2.5rem;
            font-size: 1.5rem;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .slider-nav button:hover {
            background-color: white;
        }
        .dark .slider-nav button {
            background-color: rgba(30, 30, 30, 0.7);
            color: #eee;
        }
        .dark .slider-nav button:hover {
            background-color: #000;
        }
        
        .slider-dots {
            position: absolute;
            bottom: 1rem;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 0.5rem;
            z-index: 20; /* Above slider images */
        }
        .slider-dot {
            width: 0.75rem;
            height: 0.75rem;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.5);
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .slider-dot.active {
            background-color: white;
        }
        .dark .slider-dot {
            background-color: rgba(0, 0, 0, 0.4);
        }
        .dark .slider-dot.active {
            background-color: #000;
        }

        /* Fake Notification Toast */
        #toast-notification {
            position: fixed;
            bottom: 1.5rem;
            left: 1.5rem;
            background-color: white;
            color: #333;
            padding: 1rem;
            border-radius: 0.5rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            z-index: 100;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            transform: translateX(-150%);
            opacity: 0;
            transition: all 0.5s ease-in-out;
            max-width: 320px;
        }
        #toast-notification.show {
            transform: translateX(0);
            opacity: 1;
        }
        .dark #toast-notification {
            background-color: #374151; /* gray-700 */
            color: #f3f4f6; /* gray-100 */
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
        }

        /* Style form inputs for dark mode */
        .form-input {
            @apply mt-1 block w-full px-4 py-3 border border-gray-300 rounded-md shadow-sm text-lg;
            @apply focus:ring-blue-500 focus:border-blue-500;
            @apply dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:placeholder-gray-400;
        }
        .form-select {
            @apply mt-1 block w-full px-4 py-3 border border-gray-300 bg-white rounded-md shadow-sm text-lg;
            @apply focus:ring-blue-500 focus:border-blue-500;
            @apply dark:bg-gray-700 dark:border-gray-600 dark:text-white;
        }

        /* NEW: Helper to hide pages */
        .page-hidden {
            display: none;
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100">

    <!-- Header -->
    <header id="header-nav" class="bg-white dark:bg-gray-800 shadow-md dark:shadow-none dark:border-b dark:border-gray-700 sticky top-0 z-40">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <h1 class="text-3xl font-bold text-blue-600 dark:text-blue-500">Survive Together</h1>
            <div class="flex items-center space-x-4">
                <a href="#home" class="text-gray-600 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 px-3 py-2 rounded-md text-lg font-medium">Home</a>
                <a href="#map-section" class="text-gray-600 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 px-3 py-2 rounded-md text-lg font-medium">Map</a>
                <a href="#stories" class="text-gray-600 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 px-3 py-2 rounded-md text-lg font-medium">Stories</a>
                <a href="#about" class="text-gray-600 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 px-3 py-2 rounded-md text-lg font-medium">About</a>
                <a href="#contact" class="text-gray-600 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 px-3 py-2 rounded-md text-lg font-medium">Contact</a>
                
                <!-- Theme Toggle Button -->
                <button id="theme-toggle-btn" class="p-2 rounded-full text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700">
                    <!-- Moon Icon -->
                    <svg id="theme-icon-moon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                    </svg>
                    <!-- Sun Icon -->
                    <svg id="theme-icon-sun" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                    </svg>
                </button>
            </div>
        </nav>
    </header>

    <!-- NEW: Home Page Wrapper -->
    <div id="home-page">
        <!-- Main Content -->
        <main class="container mx-auto px-6 py-12">
            
            <!-- Hero Section with Background Image -->
            <!-- MODIFIED: Removed inline bg-image, added slider div -->
            <section id="home" class="hero-background text-white text-center py-20 md:py-32 mb-16 rounded-lg overflow-hidden">
                
                <!-- NEW: Hero Slider Container -->
                <div id="hero-slider" class="absolute inset-0 z-0">
                    <div class="hero-slide" style="background-image: url('https://image.pollinations.ai/prompt/Flood%20impact%20on%20village,%20poignant,%20sad%20sky,%20realistic?width=1600&height=900&seed=123'); opacity: 1;"></div>
                    <div class="hero-slide" style="background-image: url('https://image.pollinations.ai/prompt/Community%20resilience%20after%20flood,%20people%20helping%20each%20other,%20hopeful%20sunset,%20realistic?width=1600&height=900&seed=456');"></div>
                    <div class="hero-slide" style="background-image: url('https://image.pollinations.ai/prompt/People%20actively%20helping%20flood%20victims,%20distributing%20aid,%20hopeful%20and%20encouraging,%20realistic?width=1600&height=900&seed=789');"></div>
                </div>

                <div class="hero-content max-w-4xl mx-auto px-4">
                    <h2 class="text-5xl md:text-6xl font-extrabold mb-4 drop-shadow-lg">Connecting Communities in Crisis</h2>
                    <p class="text-xl md:text-2xl max-w-3xl mx-auto drop-shadow-md">
                        In times of need, nobody should be alone. <span class="font-semibold text-blue-300">Survive Together</span> is a platform to connect those who need help with those who can provide it.
                    </p>
                </div>
            </section>

            <!-- Call-to-Action Buttons -->
            <section class="max-w-4xl mx-auto mb-16">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    
                    <!-- Sufferer Button (MODIFIED: ID changed) -->
                    <button id="sufferer-page-btn" class="w-full bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 text-white font-bold p-6 rounded-lg shadow-xl dark:shadow-lg dark:shadow-blue-900/50 transform hover:-translate-y-1 transition duration-300 ease-in-out group">
                        <div class="flex items-center space-x-4">
                            <img src="https://image.pollinations.ai/prompt/Community%20resilience%20after%20flood,%20people%20helping%20each%20other,%20hopeful%20sunset,%20realistic?width=80&height=80&seed=456" 
                                 class="w-20 h-20 rounded-lg flex-shrink-0 object-cover group-hover:scale-105 transition-transform duration-300" 
                                 alt="Community Help Icon">
                            <div class="text-left">
                                <h3 class="text-2xl font-bold">🤝 Sufferer</h3>
                                <p class="text-lg font-normal mt-1">Find resources and support near you.</p>
                            </div>
                        </div>
                    </button>

                    <!-- Volunteer Button (MODIFIED: ID changed) -->
                    <button id="volunteer-page-btn" class="w-full bg-green-600 hover:bg-green-700 dark:bg-green-500 dark:hover:bg-green-600 text-white font-bold p-6 rounded-lg shadow-xl dark:shadow-lg dark:shadow-green-900/50 transform hover:-translate-y-1 transition duration-300 ease-in-out group">
                        <div class="flex items-center space-x-4">
                            <img src="https://image.pollinations.ai/prompt/People%20actively%20helping%20flood%20victims,%20distributing%20aid,%20hopeful%20and%20encouraging,%20realistic?width=80&height=80&seed=789" 
                                 class="w-20 h-20 rounded-lg flex-shrink-0 object-cover group-hover:scale-105 transition-transform duration-300" 
                                 alt="Offer Help Icon">
                            <div class="text-left">
                                <h3 class="text-2xl font-bold">❤️ Volunteer</h3>
                                <p class="text-lg font-normal mt-1">Offer support, donations, or volunteer.</p>
                            </div>
                        </div>
                    </button>

                </div>
            </section>

            <!-- NEW Map Section -->
            <section id="map-section" class="mb-16 pt-16">
                <h3 class="text-4xl font-bold text-center text-gray-800 dark:text-gray-100 mb-8">Live Affected Areas</h3>
                <p class="text-xl text-gray-700 dark:text-gray-300 max-w-3xl mx-auto text-center mb-8">
                    This map shows real-time (simulated) reports of flood-affected regions. Click on a hotspot to learn more.
                </p>
                <div id="map" class="shadow-lg"></div>
            </section>


            <!-- Image Showcase Slider -->
            <section class="mb-16">
                <h3 class="text-4xl font-bold text-center text-gray-800 dark:text-gray-100 mb-8">Glimpses of Hope</h3>
                <div class="slider-container">
                    <div class="slider-wrapper">
                        <div class="slider-slide">
                            <img src="https://image.pollinations.ai/prompt/Family%20receiving%20aid%20after%20flood,%20grateful%20and%20relieved%20expressions,%20hopeful%20lighting,%20realistic?width=800&height=450&seed=1011" alt="Family receiving aid">
                        </div>
                        <div class="slider-slide">
                            <img src="https://image.pollinations.ai/prompt/People%20donating%20money%20to%20a%20charity%20box,%20community%20fundraiser,%20hands%20exchanging%20money,%20encouraging%20and%20realistic?width=800&height=450&seed=1314" alt="People donating money">
                        </div>
                        <div class="slider-slide">
                            <img src="https://image.pollinations.ai/prompt/Community%20resilience%20after%20flood,%20people%20helping%20each%20other,%20hopeful%20sunset,%20realistic?width=800&height=450&seed=456" alt="Community resilience">
                        </div>
                        <div class="slider-slide">
                            <img src="https://image.pollinations.ai/prompt/People%20actively%20helping%20flood%20victims,%20distributing%20aid,%20hopeful%20and%20encouraging,%20realistic?width=800&height=450&seed=789" alt="People actively helping">
                        </div>
                    </div>
                    <div class="slider-nav">
                        <button id="prevSlide">❮</button>
                        <button id="nextSlide">❯</button>
                    </div>
                    <div class="slider-dots"></div>
                </div>
            </section>
            
            <!-- Stories Section -->
            <section id="stories" class="mb-20 pt-16">
                <h3 class="text-4xl font-bold text-center text-gray-800 dark:text-gray-100 mb-12">Stories of Survival & Support</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    
                    <!-- Story Card 1 -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden flex flex-col">
                        <img src="https://image.pollinations.ai/prompt/Grateful%20Indian%20woman%20smiling%20after%20disaster,%20hopeful,%20realistic?width=400&height=250&seed=1" alt="Meena's Story" class="w-full h-48 object-cover">
                        <div class="p-6 flex-grow">
                            <h4 class="text-2xl font-semibold mb-2 text-blue-600 dark:text-blue-400">Meena's Story: Finding Shelter</h4>
                            <p class="text-gray-600 dark:text-gray-300 mb-4 italic">"We lost everything in the flood. Thanks to a volunteer on this platform, my children and I found a safe place to sleep. We are so grateful."</p>
                        </div>
                        <a href="#" class="block p-4 text-center bg-gray-50 dark:bg-gray-700 text-blue-600 dark:text-blue-300 font-medium hover:bg-gray-100 dark:hover:bg-gray-600 transition">Read More</a>
                    </div>
                    
                    <!-- Story Card 2 -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden flex flex-col">
                        <img src="https://image.pollinations.ai/prompt/Young%20Indian%20man%20volunteering,%20handing%20out%20water,%20realistic?width=400&height=250&seed=2" alt="Raj's Story" class="w-full h-48 object-cover">
                        <div class="p-6 flex-grow">
                            <h4 class="text-2xl font-semibold mb-2 text-green-600 dark:text-green-400">Raj's Story: Making a Difference</h4>
                            <p class="text-gray-600 dark:text-gray-300 mb-4 italic">"I just had my car and some free time. I signed up as a volunteer, and within an hour I was transporting medical supplies to a family that couldn't get out."</p>
                        </div>
                        <a href="#" class="block p-4 text-center bg-gray-50 dark:bg-gray-700 text-green-600 dark:text-green-300 font-medium hover:bg-gray-100 dark:hover:bg-gray-600 transition">Read More</a>
                    </div>
                    
                    <!-- Story Card 3 -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden flex flex-col">
                        <img src="https://image.pollinations.ai/prompt/Community%20kitchen%20in%20India,%20serving%20food%20after%20flood,%20realistic?width=400&height=250&seed=3" alt="Community Kitchen" class="w-full h-48 object-cover">
                        <div class="p-6 flex-grow">
                            <h4 class="text-2xl font-semibold mb-2 text-yellow-600 dark:text-yellow-400">Impact: The Community Kitchen</h4>
                            <p class="text-gray-600 dark:text-gray-300 mb-4 italic">"Your small donations helped us set up a kitchen that is now feeding over 200 people a day. It's more than food; it's a place of hope."</p>
                        </div>
                        <a href="#" class="block p-4 text-center bg-gray-50 dark:bg-gray-700 text-yellow-600 dark:text-yellow-300 font-medium hover:bg-gray-100 dark:hover:bg-gray-600 transition">Read More</a>
                    </div>
                    
                </div>
            </section>

            <!-- Donation Progress Bar Section (Live Counter) -->
            <section class="mb-16 bg-blue-50 dark:bg-gray-800 p-8 rounded-lg shadow-lg text-center">
                <h3 class="text-4xl font-bold text-gray-800 dark:text-gray-100 mb-4">Our Collective Impact</h3>
                
                <div class="text-center mb-4">
                    <span class="text-lg font-medium text-gray-600 dark:text-gray-300">Total Support Raised</span>
                    <div id="amountRaisedText" class="text-5xl font-bold text-gray-800 dark:text-white my-2">₹1,50,000</div>
                </div>

                <div class="relative w-full bg-gray-200 dark:bg-gray-700 rounded-full h-8 mb-4">
                    <!-- 4. REMOVED bg-green-500 class, as the shimmer CSS now handles the color -->
                    <div class="progress-bar-fill h-8 rounded-full" 
                         role="progressbar" 
                         aria-valuenow="30" 
                         aria-valuemin="0" 
                         aria-valuemax="100" 
                         style="width: 30%;">
                    </div>
                </div>
                <p id="donationStatusText" class="text-lg text-gray-600 dark:text-gray-300 transition-colors duration-300">Your support is invaluable!</p>
            </section>


            <!-- About Us Section -->
            <section id="about" class="mt-20 pt-16 text-center">
                <h3 class="text-4xl font-bold text-gray-800 dark:text-gray-100 mb-6">About Us</h3>
                <p class="text-xl text-gray-700 dark:text-gray-300 max-w-3xl mx-auto mb-12">
                    Our mission is simple: to build a bridge of support between those affected by crisis and those with the will to help. 
                    We believe in the power of community and technology to bring immediate, effective, and compassionate relief.
                </p>
                <h4 class="text-3xl font-semibold text-gray-800 dark:text-gray-100 mb-8">How It Works</h4>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <!-- Step 1 -->
                    <div class="bg-white dark:bg-gray-800 p-8 rounded-lg shadow-lg">
                        <div class="bg-blue-100 dark:bg-blue-900/50 text-blue-600 dark:text-blue-300 rounded-full h-16 w-16 flex items-center justify-center mx-auto mb-4">
                            <span class="text-3xl font-bold">1</span>
                        </div>
                        <h4 class="text-2xl font-semibold mb-2 dark:text-gray-100">Choose Your Path</h4>
                        <p class="text-gray-600 dark:text-gray-300">Select whether you are a sufferer or a volunteer.</p>
                    </div>
                    <!-- Step 2 -->
                    <div class="bg-white dark:bg-gray-800 p-8 rounded-lg shadow-lg">
                        <div class="bg-blue-100 dark:bg-blue-900/50 text-blue-600 dark:text-blue-300 rounded-full h-16 w-16 flex items-center justify-center mx-auto mb-4">
                            <span class="text-3xl font-bold">2</span>
                        </div>
                        <h4 class="text-2xl font-semibold mb-2 dark:text-gray-100">Fill Out the Form</h4>
                        <p class="text-gray-600 dark:text-gray-300">Provide details about your needs or what you can offer.</p>
                    </div>
                    <!-- Step 3 -->
                    <div class="bg-white dark:bg-gray-800 p-8 rounded-lg shadow-lg">
                        <div class="bg-blue-100 dark:bg-blue-900/50 text-blue-600 dark:text-blue-300 rounded-full h-16 w-16 flex items-center justify-center mx-auto mb-4">
                            <span class="text-3xl font-bold">3</span>
                        </div>
                        <h4 class="text-2xl font-semibold mb-2 dark:text-gray-100">Get Connected</h4>
                        <p class="text-gray-600 dark:text-gray-300">We match you with local resources and volunteers.</p>
                    </div>
                </div>
            </section>

            <!-- Contact Us Section -->
            <section id="contact" class="mt-20 pt-16 text-center bg-white dark:bg-gray-800 p-12 rounded-lg shadow-lg">
                <h3 class="text-4xl font-bold text-gray-800 dark:text-gray-100 mb-6">Get In Touch</h3>
                <p class="text-xl text-gray-700 dark:text-gray-300 max-w-2xl mx-auto mb-4">
                    Have questions or need to speak with our team directly? 
                    Please don't hesitate to reach out. We are here to help.
                </p>
                <a href="mailto:contact@survivetogether.fake" class="text-2xl font-semibold text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 transition duration-300">
                    contact@survivetogether.fake
                </a>
            </section>
        </main>
    </div> <!-- END of home-page wrapper -->

    <!-- NEW: Sufferer Page -->
    <div id="sufferer-page" class="page-hidden container mx-auto px-6 py-12 min-h-screen">
        <!-- Back button -->
        <button class="back-to-home-btn text-blue-600 dark:text-blue-400 font-medium mb-8 hover:underline">&larr; Back to Home</button>
        
        <!-- Sufferer Form Container -->
        <div id="sufferer-form-container" class="max-w-lg mx-auto bg-white dark:bg-gray-800 p-8 rounded-lg shadow-lg">
            <h3 class="text-3xl font-semibold text-gray-800 dark:text-gray-100 mb-6">Sufferer Assistance</h3>
            <form id="sufferer-form">
                <p class="text-gray-600 dark:text-gray-300 mb-6 text-lg">Please let us know what you need. All information is confidential.</p>
                <div class="space-y-4">
                    <div>
                        <label for="name" class="block text-lg font-medium text-gray-700 dark:text-gray-200">Full Name</label>
                        <input type="text" id="name" name="name" required class="form-input">
                    </div>
                    <div>
                        <label for="email" class="block text-lg font-medium text-gray-700 dark:text-gray-200">Email Address</label>
                        <input type="email" id="email" name="email" required class="form-input">
                    </div>
                    <div>
                        <label for="phone" class="block text-lg font-medium text-gray-700 dark:text-gray-200">Phone Number</label>
                        <input type="tel" id="phone" name="phone" class="form-input">
                    </div>
                    <div>
                        <label for="needs" class="block text-lg font-medium text-gray-700 dark:text-gray-200">What do you need help with?</label>
                        <select id="needs" name="needs" class="form-select">
                            <option>Food / Groceries</option>
                            <option>Shelter</option>
                            <option>Medical Supplies</option>
                            <option>Transportation</option>
                            <option>Other</option>
                        </select>
                    </div>
                    <div>
                        <div class="flex justify-between items-center">
                            <label for="details" class="block text-lg font-medium text-gray-700 dark:text-gray-200">Additional Details</label>
                            <button type="button" id="suggestDetailsBtn" class="text-sm text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium">✨ Help Me List My Needs</button>
                        </div>
                        <textarea id="details" name="details" rows="4" class="form-input" placeholder="Be as specific as possible..."></textarea>
                    </div>
                    
                    <!-- Gemini Hope Message Feature -->
                    <div class="pt-2 text-center">
                        <button type="button" id="getHopeBtn" class="w-full bg-gray-100 dark:bg-gray-700 text-blue-700 dark:text-blue-300 py-2 px-4 rounded-lg text-md font-medium hover:bg-gray-200 dark:hover:bg-gray-600 transition duration-300 border border-blue-200 dark:border-blue-800">✨ Get a Hopeful Message</button>
                        <div id="hopeMessage" class="mt-4 p-4 bg-blue-50 dark:bg-gray-700 text-blue-800 dark:text-blue-200 rounded-lg hidden text-left font-medium"></div>
                    </div>

                    <div class="pt-2">
                        <button type="submit" class="w-full bg-blue-600 text-white py-3 px-6 rounded-lg text-lg font-medium hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 transition duration-300">
                            Submit Request
                        </button>
                    </div>
                </div>
            </form>
        </div>
        
        <!-- Sufferer Success Message -->
        <div id="sufferer-success" class="page-hidden text-center max-w-lg mx-auto bg-white dark:bg-gray-800 p-8 rounded-lg shadow-lg mt-8">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-20 w-20 text-green-500 mx-auto mb-4" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
            </svg>
            <h4 class="text-3xl font-semibold text-gray-800 dark:text-gray-100 mb-2">Thank You!</h4>
            <p class="text-lg text-gray-600 dark:text-gray-300">Your request has been submitted. We will be in touch soon.</p>
            <button type="button" class="back-to-home-btn mt-6 w-full bg-blue-600 text-white py-3 px-6 rounded-lg text-lg font-medium hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 transition duration-300">
                Done
            </button>
        </div>
    </div>

    <!-- NEW: Volunteer Page -->
    <div id="volunteer-page" class="page-hidden container mx-auto px-6 py-12 min-h-screen">
        <!-- Back button -->
        <button class="back-to-home-btn text-blue-600 dark:text-blue-400 font-medium mb-8 hover:underline">&larr; Back to Home</button>
        
        <!-- Volunteer Form Container -->
        <div id="volunteer-form-container" class="max-w-lg mx-auto bg-white dark:bg-gray-800 p-8 rounded-lg shadow-lg">
            <h3 class="text-3xl font-semibold text-gray-800 dark:text-gray-100 mb-6">Volunteer Support</h3>
            <form id="volunteer-form">
                <p class="text-gray-600 dark:text-gray-300 mb-6 text-lg">Thank you for your kindness. Please let us know how you can help.</p>
                <div class="space-y-4">
                    <div>
                        <label for="name-vol" class="block text-lg font-medium text-gray-700 dark:text-gray-200">Full Name</label>
                        <input type="text" id="name-vol" name="name" required class="form-input">
                    </div>
                    <div>
                        <label for="email-vol" class="block text-lg font-medium text-gray-700 dark:text-gray-200">Email Address</label>
                        <input type="email" id="email-vol" name="email" required class="form-input">
                    </div>
                    <div>
                        <label for="phone-vol" class="block text-lg font-medium text-gray-700 dark:text-gray-200">Phone Number</label>
                        <input type="tel" id="phone-vol" name="phone" class="form-input">
                    </div>
                    <div>
                        <label for="offerings" class="block text-lg font-medium text-gray-700 dark:text-gray-200">What can you offer?</label>
                        <select id="offerings" name="offerings" class="form-select">
                            <option>Volunteer Time</option>
                            <option>Donations (Money)</option>
                            <option>Donations (Goods)</option>
                            <option>Transportation</option>
                            <option>Other</option>
                        </select>
                    </div>
                    
                    <!-- Gemini Volunteer Ideas Feature -->
                    <div id="volunteerIdeasContainer" class="hidden space-y-2">
                        <button type="button" id="getVolunteerIdeasBtn" class="w-full bg-gray-100 dark:bg-gray-700 text-green-700 dark:text-green-300 py-2 px-4 rounded-lg text-md font-medium hover:bg-gray-200 dark:hover:bg-gray-600 transition duration-300 border border-green-200 dark:border-green-800">✨ Get Volunteer Ideas</button>
                        <ul id="volunteerIdeas" class="mt-4 p-4 bg-green-50 dark:bg-gray-700 text-green-800 dark:text-green-200 rounded-lg hidden text-left font-medium list-disc list-inside space-y-1"></ul>
                    </div>

                    <div>
                        <label for="availability" class="block text-lg font-medium text-gray-700 dark:text-gray-200">Availability / Details</label>
                        <input type="text" id="availability" name="availability" placeholder="e.g., Weekends, Evenings, or specific goods" class="form-input">
                    </div>
                    <div class="pt-2">
                        <button type="submit" class="w-full bg-green-600 text-white py-3 px-6 rounded-lg text-lg font-medium hover:bg-green-700 dark:bg-green-500 dark:hover:bg-green-600 transition duration-300">
                            Submit Offer
                        </button>
                    </div>
                </div>
            </form>
        </div>
        
        <!-- Volunteer Success Message (Generic) -->
        <div id="volunteer-success-generic" class="page-hidden text-center max-w-lg mx-auto bg-white dark:bg-gray-800 p-8 rounded-lg shadow-lg mt-8">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-20 w-20 text-green-500 mx-auto mb-4" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
            </svg>
            <h4 class="text-3xl font-semibold text-gray-800 dark:text-gray-100 mb-2">Thank You!</h4>
            <p class="text-lg text-gray-600 dark:text-gray-300">Your offer has been submitted. We will be in touch soon.</p>
            <button type="button" class="back-to-home-btn mt-6 w-full bg-blue-600 text-white py-3 px-6 rounded-lg text-lg font-medium hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 transition duration-300">
                Done
            </button>
        </div>
        
        <!-- Volunteer Success Message (QR Code) -->
        <div id="volunteer-success-qr" class="page-hidden text-center max-w-lg mx-auto bg-white dark:bg-gray-800 p-8 rounded-lg shadow-lg mt-8">
            <h4 class="text-3xl font-semibold text-gray-800 dark:text-gray-100 mb-4">Complete Your Donation</h4>
            <p class="text-lg text-gray-600 dark:text-gray-300 mb-6">Thank you for your generosity! Please scan the QR code below with your payment app to complete the donation.</p>
            <img id="qrCodeImg" src="https://api.qrserver.com/v1/create-qr-code/?size=180x180&data=SurviveTogether-Donation" alt="QR Code for Donation" class="mx-auto my-4 border-4 border-gray-200 dark:border-gray-600 rounded-lg bg-white">
            <p class="text-lg text-gray-700 dark:text-gray-200 font-medium">After payment, please send a screenshot to:</p>
            <p class="text-xl font-bold text-blue-600 dark:text-blue-400 my-2">donations@survivetogether.fake</p>
            <p class="text-md text-gray-500 dark:text-gray-400">This helps us track your donation and send you a receipt.</p>
            <button type="button" class="back-to-home-btn mt-8 w-full bg-blue-600 text-white py-3 px-6 rounded-lg text-lg font-medium hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 transition duration-300">
                Done
            </button>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-800 dark:bg-gray-950 text-white dark:text-gray-400 mt-16 py-8">
        <div class="container mx-auto px-6 text-center">
            <p>&copy; 2025 Survive Together. All rights reserved.</p>
            <p class="mt-2">Building stronger communities, together.</p>
        </div>
    </footer>

    <!-- Fake Notification Toast HTML -->
    <div id="toast-notification">
        <span id="toast-icon" class="text-xl"></span>
        <span id="toast-message" class="font-medium"></span>
    </div>

    <!-- Modal (REMOVED) -->

    <script>
        // === GLOBAL VARIABLES ===
        // MODAL ELEMENTS (REMOVED)
        
        // --- NEW: Page Elements ---
        const homePage = document.getElementById('home-page');
        const suffererPage = document.getElementById('sufferer-page');
        const volunteerPage = document.getElementById('volunteer-page');

        // Button elements
        const getHelpBtn = document.getElementById('sufferer-page-btn'); // Renamed ID
        const offerHelpBtn = document.getElementById('volunteer-page-btn'); // Renamed ID
        
        // --- NEW: Form and Success Elements (now page-specific) ---
        const suffererFormContainer = document.getElementById('sufferer-form-container');
        const suffererForm = document.getElementById('sufferer-form');
        const suffererSuccess = document.getElementById('sufferer-success');

        const volunteerFormContainer = document.getElementById('volunteer-form-container');
        const volunteerForm = document.getElementById('volunteer-form');
        const volunteerSuccessGeneric = document.getElementById('volunteer-success-generic');
        const volunteerSuccessQr = document.getElementById('volunteer-success-qr');
        const qrCodeImg = document.getElementById('qrCodeImg');

        // Donation Progress Bar Elements
        const progressBarFill = document.querySelector('.progress-bar-fill');
        const amountRaisedText = document.getElementById('amountRaisedText');
        const donationStatusText = document.getElementById('donationStatusText');
        
        // Donation state
        const internalGoal = 500000; // Starting at 150k, this is 30%
        let currentAmountRaised = 150000; // Starting value

        // Map variables
        let map;
        let lightTileLayer, darkTileLayer;
        const fakeAffectedAreas = [
            { lat: 26.1445, lng: 91.7362, name: 'Assam Flood Zone', level: 'High', details: 'Severe flooding in Guwahati and surrounding areas. Immediate need for medical supplies and clean water.' },
            { lat: 28.6139, lng: 77.2090, name: 'Delhi (Yamuna)', level: 'Medium', details: 'River levels rising, low-lying areas evacuated. Shelters are active.' },
            { lat: 19.0760, lng: 72.8777, name: 'Mumbai Coast', level: 'Medium', details: 'High tide and heavy rains causing waterlogging. Transportation affected.' },
            { lat: 10.8505, lng: 76.2711, name: 'Kerala Backwaters', level: 'High', details: 'Landslides and flooding reported in hilly regions. Need for rescue teams.' },
            { lat: 22.5726, lng: 88.3639, name: 'Kolkata Outskirts', level: 'Low', details: 'Waterlogging reported, situation currently under control. Monitoring active.' }
        ];

        // --- Gemini API Configuration ---
        const apiKey = ""; // Per instructions, leave empty.
        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;

        /**
         * Shows a loading state on a button
         */
        function showLoading(button, isLoading, originalText = '✨ Generate') {
            if (isLoading) {
                button.disabled = true;
                button.innerHTML = `<div class="flex items-center justify-center space-x-2">
                                        <div class="spinner"></div>
                                        <span>Loading...</span>
                                    </div>`;
            } else {
                button.disabled = false;
                button.innerHTML = originalText;
            }
        }

        /**
         * Calls the Gemini API with exponential backoff
         */
        async function callGeminiAPI(prompt, systemInstruction = null, maxRetries = 3) {
            const payload = {
                contents: [{ parts: [{ text: prompt }] }],
            };
            if (systemInstruction) {
                payload.systemInstruction = { parts: [{ text: systemInstruction }] };
            }

            let delay = 1000; // Start with 1 second
            for (let i = 0; i < maxRetries; i++) {
                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        throw new Error(`API Error: ${response.statusText}`);
                    }

                    const result = await response.json();
                    const candidate = result.candidates?.[0];

                    if (candidate && candidate.content?.parts?.[0]?.text) {
                        return candidate.content.parts[0].text;
                    } else {
                        throw new Error("Invalid response structure from API.");
                    }
                } catch (error) {
                    console.error(`Attempt ${i + 1} failed:`, error);
                    if (i === maxRetries - 1) {
                        return "Sorry, I couldn't get a response right now. Please try again later.";
                    }
                    await new Promise(resolve => setTimeout(resolve, delay));
                    delay *= 2; // Exponential backoff
                }
            }
            return "Sorry, I'm having trouble connecting. Please try again later.";
        }
        // --- End Gemini API ---


        // --- Form HTML Templates (REMOVED, now in HTML) ---


        /**
         * Animates a number counting up
         */
        function animateCountUp(element, endValue, duration = 1500) {
            const startValue = parseInt(element.innerText.replace(/₹|,/g, '')) || 0;
            const change = endValue - startValue;
            let startTime = null;

            function step(timestamp) {
                if (!startTime) startTime = timestamp;
                const progress = Math.min((timestamp - startTime) / duration, 1);
                const easedProgress = progress * (2 - progress);
                const currentValue = Math.floor(easedProgress * change + startValue);
                
                element.innerText = `₹${currentValue.toLocaleString('en-IN')}`;
                
                if (progress < 1) {
                    requestAnimationFrame(step);
                }
            }
            requestAnimationFrame(step);
        }

        /**
         * Updates the donation tracker (text and bar)
         */
        const updateDonationTracker = (donationAmount, useAnimation = true) => {
            const newTotal = currentAmountRaised + donationAmount;
            
            if (useAnimation) {
                animateCountUp(amountRaisedText, newTotal, 1500);
            } else {
                amountRaisedText.innerText = `₹${newTotal.toLocaleString('en-IN')}`;
            }

            const newPercentage = (newTotal / internalGoal) * 100;
            progressBarFill.style.width = `${Math.min(newPercentage, 100)}%`;
            progressBarFill.setAttribute('aria-valuenow', newPercentage);

            currentAmountRaised = newTotal;

            donationStatusText.innerText = "Increasing...";
            donationStatusText.classList.add('text-green-600', 'dark:text-green-400');

            setTimeout(() => {
                donationStatusText.innerText = "Your support is invaluable!";
                donationStatusText.classList.remove('text-green-600', 'dark:text-green-400');
            }, 2000);
        };

        // --- NEW: Page Navigation Logic ---
        /**
         * Shows a page by ID and hides others
         */
        function showPage(pageId) {
            // Hide all pages
            homePage.classList.add('page-hidden');
            suffererPage.classList.add('page-hidden');
            volunteerPage.classList.add('page-hidden');
            
            // Show the target page
            const targetPage = document.getElementById(pageId);
            if (targetPage) {
                targetPage.classList.remove('page-hidden');
            }

            // Scroll to top
            window.scrollTo(0, 0);
        }

        /**
         * Resets and shows the home page
         */
        function goToHome() {
            showPage('home-page');

            // Reset Sufferer page
            suffererForm.reset();
            suffererFormContainer.style.display = 'block';
            suffererSuccess.style.display = 'none';
            document.getElementById('hopeMessage').classList.add('hidden');

            // Reset Volunteer page
            volunteerForm.reset();
            volunteerFormContainer.style.display = 'block';
            volunteerSuccessGeneric.style.display = 'none';
            volunteerSuccessQr.style.display = 'none';
            document.getElementById('volunteerIdeasContainer').classList.add('hidden');
            document.getElementById('volunteerIdeas').classList.add('hidden');
        }
        // --- End Page Navigation Logic ---


        // --- Gemini Event Listener Functions (REMOVED, logic moved to DOMContentLoaded) ---
        
        // --- Map Initialization ---
        function initMap(isDarkMode) {
            // Define Tile Layers
            lightTileLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            });
            
            darkTileLayer = L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>'
            });
            
            // Initialize Map
            map = L.map('map').setView([20.5937, 78.9629], 5); // Center on India
            
            // Add initial tile layer based on theme
            if (isDarkMode) {
                darkTileLayer.addTo(map);
            } else {
                lightTileLayer.addTo(map);
            }

            // Add markers for fake data
            fakeAffectedAreas.forEach(area => {
                const color = area.level === 'High' ? 'red' : (area.level === 'Medium' ? 'orange' : 'yellow');
                
                L.circle([area.lat, area.lng], {
                    color: color,
                    fillColor: color,
                    fillOpacity: 0.4,
                    radius: area.level === 'High' ? 80000 : 50000
                }).addTo(map)
                  .bindPopup(`
                    <strong style="color: ${color};">${area.name}</strong><br>
                    <strong>Alert Level:</strong> ${area.level}<br>
                    <p>${area.details}</p>
                  `);
            });
        }
        
        function switchMapTheme(isDarkMode) {
            if (!map) return; // Don't run if map isn't initialized
            
            if (isDarkMode) {
                if (map.hasLayer(lightTileLayer)) {
                    map.removeLayer(lightTileLayer);
                }
                if (!map.hasLayer(darkTileLayer)) {
                    map.addLayer(darkTileLayer);
                }
            } else {
                if (map.hasLayer(darkTileLayer)) {
                    map.removeLayer(darkTileLayer);
                }
                if (!map.hasLayer(lightTileLayer)) {
                    map.addLayer(lightTileLayer);
                }
            }
        }
        // --- End Map Logic ---

        // --- Image Slider Logic ---
        const sliderWrapper = document.querySelector('.slider-wrapper');
        const slides = document.querySelectorAll('.slider-slide');
        const nextBtn = document.getElementById('nextSlide');
        const prevBtn = document.getElementById('prevSlide');
        const dotsContainer = document.querySelector('.slider-dots');
        let currentSlide = 0;
        let autoPlayInterval = setInterval(nextSlide, 5000);

        function createDots() {
            slides.forEach((_, i) => {
                const dot = document.createElement('div');
                dot.classList.add('slider-dot');
                if (i === 0) dot.classList.add('active');
                dot.addEventListener('click', () => goToSlide(i));
                dotsContainer.appendChild(dot);
            });
        }

        function updateDots() {
            const dots = document.querySelectorAll('.slider-dot');
            dots.forEach((dot, i) => {
                dot.classList.toggle('active', i === currentSlide);
            });
        }

        function goToSlide(slideIndex) {
            currentSlide = (slideIndex + slides.length) % slides.length;
            sliderWrapper.style.transform = `translateX(-${currentSlide * 100}%)`;
            updateDots();
            resetAutoPlay();
        }

        function nextSlide() {
            goToSlide(currentSlide + 1);
        }

        function prevSlide() {
            goToSlide(currentSlide - 1);
        }

        function resetAutoPlay() {
            clearInterval(autoPlayInterval);
            autoPlayInterval = setInterval(nextSlide, 5000);
        }

        nextBtn.addEventListener('click', nextSlide);
        prevBtn.addEventListener('click', prevSlide);
        createDots();
        // --- End Image Slider Logic ---


        // --- Fake Notification Toast Logic ---
        const toast = document.getElementById('toast-notification');
        const toastIcon = document.getElementById('toast-icon');
        const toastMessage = document.getElementById('toast-message');
        
        const randomNames = ["Ravi", "Meena", "Sonal", "Amit", "Priya", "Raj", "Sunita", "Vikram", "Anjali", "Karan", "Pooja"];
        const randomEmojis = ['❤️', '🙌', '✨', '🙏', '🎉'];

        function showToast() {
            const randomName = randomNames[Math.floor(Math.random() * randomNames.length)];
            let message = '';
            let icon = '';

            if (Math.random() < 0.25) { // 25% chance for non-donation message
                message = `${randomName} just signed up to volunteer!`;
                icon = '🤝';
            } else {
                const randomAmount = Math.floor(Math.random() * 450 + 50) * 10; // 500 to 5000, in steps of 10
                const randomEmoji = randomEmojis[Math.floor(Math.random() * randomEmojis.length)];
                message = `${randomName} just donated ₹${randomAmount.toLocaleString('en-IN')}! ${randomEmoji}`;
                icon = '❤️';
            }
            
            toastIcon.innerText = icon;
            toastMessage.innerText = message;
            toast.classList.add('show');

            // Hide toast after 5 seconds
            setTimeout(() => {
                toast.classList.remove('show');
            }, 5000);
        }
        
        // Show a toast every 12 seconds
        setInterval(showToast, 12000);
        // Show one on load after a delay
        setTimeout(showToast, 3000);
        // --- End Fake Notification Toast Logic ---
        
        // --- Theme Toggle Logic ---
        const themeToggleBtn = document.getElementById('theme-toggle-btn');
        const moonIcon = document.getElementById('theme-icon-moon');
        const sunIcon = document.getElementById('theme-icon-sun');

        function updateThemeIcons(isDarkMode) {
            if (isDarkMode) {
                moonIcon.classList.add('hidden');
                sunIcon.classList.remove('hidden');
            } else {
                moonIcon.classList.remove('hidden');
                sunIcon.classList.add('hidden');
            }
        }
        
        themeToggleBtn.addEventListener('click', () => {
            const isDark = document.documentElement.classList.toggle('dark');
            localStorage.theme = isDark ? 'dark' : 'light';
            updateThemeIcons(isDark);
            switchMapTheme(isDark); // Switch map theme
        });
        
        // --- End Theme Toggle Logic ---


        // --- Rapid Auto-Increment for Live Counter ---
        function startRapidCounter() {
            setInterval(() => {
                const randomMicroDonation = Math.floor(Math.random() * 101) + 100; // 100 to 200
                
                const newTotal = currentAmountRaised + randomMicroDonation;
                
                // We will *not* animate the number, just set it, for a "ticking" effect
                amountRaisedText.innerText = `₹${newTotal.toLocaleString('en-IN')}`;

                // We will *not* animate the bar width, just set it
                const newPercentage = (newTotal / internalGoal) * 100;
                progressBarFill.style.width = `${Math.min(newPercentage, 100)}%`;
                progressBarFill.setAttribute('aria-valuenow', newPercentage);

                // Update the global total
                currentAmountRaised = newTotal;

            }, 2500); // Ticks up every 2.5 seconds
        }
        // --- END: Rapid Auto-Increment ---

        // --- NEW: Hero Background Slider Logic ---
        function initHeroSlider() {
            let currentHeroSlide = 0;
            const heroSlides = document.querySelectorAll('#hero-slider .hero-slide');
            const totalHeroSlides = heroSlides.length;

            if (totalHeroSlides === 0) return;

            function cycleHeroSlides() {
                // Get the last slide index
                const lastSlide = (currentHeroSlide - 1 + totalHeroSlides) % totalHeroSlides;
                
                // Fade out the last slide
                heroSlides[lastSlide].style.opacity = 0;
                // Fade in the current slide
                heroSlides[currentHeroSlide].style.opacity = 1;
                
                // Move to the next slide index
                currentHeroSlide = (currentHeroSlide + 1) % totalHeroSlides;
            }
            
            // Start the slider
            setInterval(cycleHeroSlides, 5000); // Change slide every 5 seconds
        }
        // --- END: Hero Background Slider Logic ---


        // Initialize everything on load
        document.addEventListener('DOMContentLoaded', () => {
            const isDark = document.documentElement.classList.contains('dark');
            
            // Set initial state of theme toggle
            updateThemeIcons(isDark);
            
            // Set initial state of progress bar and text
            const initialPercentage = (currentAmountRaised / internalGoal) * 100;
            progressBarFill.style.width = `${initialPercentage}%`;
            progressBarFill.setAttribute('aria-valuenow', initialPercentage);
            amountRaisedText.innerText = `₹${currentAmountRaised.toLocaleString('en-IN')}`;
            
            // Start the rapid counter!
            startRapidCounter();
            
            // Start the hero slider!
            initHeroSlider();

            // Initialize the map
            initMap(isDark);

            // --- NEW: Page Navigation Listeners ---
            getHelpBtn.addEventListener('click', () => {
                showPage('sufferer-page');
            });

            offerHelpBtn.addEventListener('click', () => {
                showPage('volunteer-page');
            });

            // Add listeners for all "Back to Home" buttons
            document.querySelectorAll('.back-to-home-btn').forEach(btn => {
                btn.addEventListener('click', goToHome);
            });

            // Add listeners for header navigation
            document.querySelectorAll('#header-nav nav a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function(e) {
                    const href = this.getAttribute('href');
                    
                    // If we're on a sub-page, always go home first
                    if (homePage.classList.contains('page-hidden')) {
                        goToHome();
                    }
                    
                    // Let the smooth scroll take over
                    if (href === '#home') {
                        e.preventDefault();
                        window.scrollTo({ top: 0, behavior: 'smooth' });
                    } else {
                        // The default anchor link behavior will work
                        // because scroll-smooth is on the <html> tag
                    }
                });
            });

            // --- NEW: Form Submission Listeners ---
            suffererForm.addEventListener('submit', (e) => {
                e.preventDefault();
                suffererFormContainer.style.display = 'none';
                suffererSuccess.style.display = 'block';
            });

            volunteerForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const offeringsSelect = document.getElementById('offerings');
                const isDonation = offeringsSelect && offeringsSelect.value === 'Donations (Money)';

                volunteerFormContainer.style.display = 'none';

                if (isDonation) {
                    const randomData = `SurviveTogether-Donation-ID-${Math.random().toString(36).substring(7)}`;
                    qrCodeImg.src = `https://api.qrserver.com/v1/create-qr-code/?size=180x180&data=${encodeURIComponent(randomData)}`;
                    
                    volunteerSuccessQr.style.display = 'block';

                    // Simulate an increase in the progress bar
                    const randomDonation = Math.floor(Math.random() * 4501) + 500; // 500 to 5000
                    updateDonationTracker(randomDonation, true); // Call updated function with animation

                } else {
                    volunteerSuccessGeneric.style.display = 'block';
                }
            });

            // --- NEW: Gemini Listeners (moved from functions) ---
            
            // Sufferer Page Listeners
            const suggestDetailsBtn = document.getElementById('suggestDetailsBtn');
            const getHopeBtn = document.getElementById('getHopeBtn');
            const hopeMessageDiv = document.getElementById('hopeMessage');
            const detailsTextarea = document.getElementById('details');
            const needsSelect = document.getElementById('needs');

            if(suggestDetailsBtn) {
                suggestDetailsBtn.addEventListener('click', async () => {
                    const need = needsSelect.value;
                    const originalText = '✨ Help Me List My Needs';
                    showLoading(suggestDetailsBtn, true, originalText);
                    
                    const prompt = `I am filling out a form for disaster relief. The category I selected is "${need}". 
    Give me 3-4 specific examples of what to write in the 'Additional Details' section to get the best help.
    Format the response as a single block of text, with each example on a new line.
    Do not add any intro or outro text.
    Example:
    - Need baby formula (Enfamil) and size 4 diapers.
    - Two adults, one child (age 3).
    - Stranded at [Location], no clean water.`;
                    
                    const suggestions = await callGeminiAPI(prompt, "You are a helpful assistant for a disaster relief website.");
                    detailsTextarea.value = suggestions;
                    showLoading(suggestDetailsBtn, false, originalText);
                });
            }

            if(getHopeBtn) {
                getHopeBtn.addEventListener('click', async () => {
                    const originalText = '✨ Get a Hopeful Message';
                    showLoading(getHopeBtn, true, originalText);
                    hopeMessageDiv.classList.add('hidden');

                    const prompt = "Write a short, 1-2 sentence hopeful and encouraging message for someone who has been affected by a natural disaster and is asking for " +
    "help.";
                    const message = await callGeminiAPI(prompt, "You are a kind and supportive counselor.");
                    
                    hopeMessageDiv.innerText = message;
                    hopeMessageDiv.classList.remove('hidden');
                    showLoading(getHopeBtn, false, originalText);
                });
            }

            // Volunteer Page Listeners
            const offeringsSelect = document.getElementById('offerings');
            const volunteerContainer = document.getElementById('volunteerIdeasContainer');
            const getVolunteerIdeasBtn = document.getElementById('getVolunteerIdeasBtn');
            const volunteerIdeasUl = document.getElementById('volunteerIdeas');

            if(offeringsSelect) {
                if (offeringsSelect.value === 'Volunteer Time') {
                    volunteerContainer.classList.remove('hidden');
                }

                offeringsSelect.addEventListener('change', () => {
                    if (offeringsSelect.value === 'Volunteer Time') {
                        volunteerContainer.classList.remove('hidden');
                    } else {
                        volunteerContainer.classList.add('hidden');
                        volunteerIdeasUl.classList.add('hidden');
                    }
                });
            }

            if(getVolunteerIdeasBtn) {
                getVolunteerIdeasBtn.addEventListener('click', async () => {
                    const originalText = '✨ Get Volunteer Ideas';
                    showLoading(getVolunteerIdeasBtn, true, originalText);
                    volunteerIdeasUl.classList.add('hidden');

                    const prompt = `I want to volunteer my time to help after a flood, but I don't know how. 
    Give me 3 creative and practical volunteer ideas that one person can do.
    Format them as a simple list. Start each item with a *.
    Example:
    * Organize a donation drive in your neighborhood for specific items (like blankets, or canned goods).
    * Offer childcare for families busy with cleanup.`;
                    
                    const ideas = await callGeminiAPI(prompt, "You are a helpful volunteer coordinator.");
                    
                    volunteerIdeasUl.innerHTML = '';
                    const ideaList = ideas.split('*').filter(item => item.trim().length > 0);
                    ideaList.forEach(idea => {
                        const li = document.createElement('li');
                        li.innerText = idea.trim();
                        volunteerIdeasUl.appendChild(li);
                    });

                    volunteerIdeasUl.classList.remove('hidden');
                    showLoading(getVolunteerIdeasBtn, false, originalText);
                });
            }
        });

    </script>
</body>
</html>

